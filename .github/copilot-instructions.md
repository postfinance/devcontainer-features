# Copilot Instructions for devcontainer-features

## Project Overview
- This repository provides reusable devcontainer features for Dev Containers.
- Features are designed for cross-architecture (AMD64/ARM64) and cross-distro (Debian, Ubuntu, Alpine) compatibility.
- Download URLs for binaries can be globally or per-feature overridden for corporate/cached environments.
- Each feature is implemented as a self-contained directory under `features/src/<feature>/` with its own installer logic and documentation.
- Each feature is implemented as a self-contained directory under `features/test/<feature>/` with its tests.

## Key Components
- `build.go`: Responsible for the overall build process, including generating the `README.md` files and managing the build lifecycle.
- `features/src/<feature>/` — Source for each feature (e.g., go, node, docker-out, zig, git-lfs). Contains:
  - `devcontainer-feature.json`: Feature metadata and options.
  - `install.sh`, `installer.go`: Installation scripts and Go logic.
  - `README.md`: Usage and configuration options. This file is automatically generated with the "Update-Readme-Files" task from build.go.
- `features/test/<feature>/` — Tests for each feature. Contains:
  - `scenarios.json`: File containing the different scenarios to test.
  - `<scenarioname.sh>`: Verify script for each scenario
  - `test-images.json`: File containing the test images to use.
- `installer/` and `build/` — Shared Go utilities for downloading, extracting, and managing feature installation.
- `override-all.env` — Example of all possible override environment variables for download URLs.
- `README.md` — Documentation for the overall project and its features.

## Developer Workflows
- **Build**: Use Go to build/test feature logic. No monolithic build; each feature is self-contained.
- **Testing**: Test scripts are in `features/test/<feature>/`. Use shell scripts for scenario-based testing.
- **Overrides**: Set `DEV_FEATURE_OVERRIDE_LOCATION` to a file or URL for global download URL overrides. See `override-all.env` for supported keys.
- **Version Resolution**: Features support both explicit and partial versioning. Set `versionResolve: true` to enable partial version resolution.

## Project Conventions
- Prefer explicit version pinning for reproducibility; partial versions require `versionResolve: true`.
- All features support ARM64 and AMD64 where possible; Alpine support is best-effort.
- Use Go for core installer logic, with shell scripts for entrypoints.

## Integration Points
- Features can be used in any devcontainer by referencing the published image/tag.
- Download and version resolution logic is centralized in Go utilities under `installer/`.
- Global overrides are supported via environment variables or files (see `README.md`).

## Examples
- See `features/src/go/README.md` for Go feature usage and options.
- See `features/src/docker-out/README.md` for Docker client integration.

---

For more, see the root `README.md` and each feature's `README.md`. When adding new features, follow the structure and conventions above.
